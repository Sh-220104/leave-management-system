{"ast":null,"code":"import _objectSpread from\"C:/Users/VuppalaShreya/Downloads/leave-management-system/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from\"react\";import axios from\"../api\";import{useNavigate}from\"react-router-dom\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ApplyLeaveForm(){const[form,setForm]=useState({leaveTypeId:\"\",startDate:\"\",endDate:\"\",reason:\"\"});const[leaveTypes,setLeaveTypes]=useState([]);const[error,setError]=useState(\"\");const navigate=useNavigate();useEffect(()=>{axios.get(\"/leave-types\").then(res=>setLeaveTypes(res.data));},[]);const handleChange=e=>{setForm(_objectSpread(_objectSpread({},form),{},{[e.target.name]:e.target.value}));};const handleSubmit=async e=>{e.preventDefault();setError(\"\");try{await axios.post(\"/leaves/apply\",_objectSpread({employeeId:Number(localStorage.getItem(\"userId\"))},form));navigate(\"/\");}catch(e){// Automatically handle 401 Unauthorized: prompt user to login\nif(e.response&&e.response.status===401){setError(\"Session expired or unauthorized. Please login again.\");navigate(\"/login\");}else{var _e$response,_e$response$data;setError(((_e$response=e.response)===null||_e$response===void 0?void 0:(_e$response$data=_e$response.data)===null||_e$response$data===void 0?void 0:_e$response$data.message)||\"Leave application failed.\");}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Apply for Leave\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"select\",{name:\"leaveTypeId\",value:form.leaveTypeId,required:true,onChange:handleChange,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Leave Type\"}),leaveTypes.map(lt=>/*#__PURE__*/_jsx(\"option\",{value:lt.id,children:lt.type},lt.id))]}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"startDate\",value:form.startDate,required:true,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"endDate\",value:form.endDate,required:true,onChange:handleChange}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"reason\",value:form.reason,onChange:handleChange,required:true,placeholder:\"Reason\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Apply\"})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-msg\",children:error})]});}export default ApplyLeaveForm;","map":{"version":3,"names":["React","useState","useEffect","axios","useNavigate","jsx","_jsx","jsxs","_jsxs","ApplyLeaveForm","form","setForm","leaveTypeId","startDate","endDate","reason","leaveTypes","setLeaveTypes","error","setError","navigate","get","then","res","data","handleChange","e","_objectSpread","target","name","value","handleSubmit","preventDefault","post","employeeId","Number","localStorage","getItem","response","status","_e$response","_e$response$data","message","className","children","onSubmit","required","onChange","map","lt","id","type","placeholder"],"sources":["C:/Users/VuppalaShreya/Downloads/leave-management-system/frontend/src/pages/ApplyLeaveForm.jsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport axios from \"../api\";\r\nimport { useNavigate } from \"react-router-dom\";\r\n\r\nfunction ApplyLeaveForm() {\r\n  const [form, setForm] = useState({ leaveTypeId: \"\", startDate: \"\", endDate: \"\", reason: \"\" });\r\n  const [leaveTypes, setLeaveTypes] = useState([]);\r\n  const [error, setError] = useState(\"\");\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    axios.get(\"/leave-types\").then(res => setLeaveTypes(res.data));\r\n  }, []);\r\n\r\n  const handleChange = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n  };\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    try {\r\n      await axios.post(\"/leaves/apply\", {\r\n        employeeId: Number(localStorage.getItem(\"userId\")),\r\n        ...form,\r\n      });\r\n      navigate(\"/\");\r\n    } catch (e) {\r\n      // Automatically handle 401 Unauthorized: prompt user to login\r\n      if (e.response && e.response.status === 401) {\r\n        setError(\"Session expired or unauthorized. Please login again.\");\r\n        navigate(\"/login\");\r\n      } else {\r\n        setError(e.response?.data?.message || \"Leave application failed.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"form-container\">\r\n      <h2>Apply for Leave</h2>\r\n      <form onSubmit={handleSubmit}>\r\n        <select name=\"leaveTypeId\" value={form.leaveTypeId} required onChange={handleChange}>\r\n          <option value=\"\">Select Leave Type</option>\r\n          {leaveTypes.map(lt => (\r\n            <option key={lt.id} value={lt.id}>{lt.type}</option>\r\n          ))}\r\n        </select>\r\n        <input type=\"date\" name=\"startDate\" value={form.startDate} required onChange={handleChange} />\r\n        <input type=\"date\" name=\"endDate\" value={form.endDate} required onChange={handleChange} />\r\n        <input type=\"text\" name=\"reason\" value={form.reason} onChange={handleChange} required placeholder=\"Reason\" />\r\n        <button type=\"submit\">Apply</button>\r\n      </form>\r\n      {error && <div className=\"error-msg\">{error}</div>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ApplyLeaveForm;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}